const{ipcRenderer:ipcRenderer}=require("electron");let dateNow,date=new Date,nameMakeUp=document.querySelector("#nameMakeUp"),idPersonalmakeUp=document.querySelector("#idPersonalmakeUp"),phoneMakeUp=document.querySelector("#phoneMakeUp"),numReserve=document.querySelector("#numReserve"),dateReserve=document.querySelector("#dateReserve"),nameReserve=document.querySelector("#nameReserve"),typeMakeUp=document.querySelector("#typeMakeUp"),priceMakeUp=document.querySelector("#priceMakeUp"),paidMakeUp=document.querySelector("#paidMakeUp"),remainMakeUp=document.querySelector("#remainMakeUp");dateNow=date.getMonth()+1<10&&date.getDate()<10?`${date.getFullYear()}-0${date.getMonth()+1}-0${date.getDate()}`:date.getMonth()+1<10&&date.getDate()>10?`${date.getFullYear()}-0${date.getMonth()+1}-${date.getDate()}`:date.getMonth()+1>10&&date.getDate()<10?`${date.getFullYear()}-${date.getMonth()+1}-0${date.getDate()}`:`${date.getFullYear()}-${date.getMonth()+1}-${date.getDate()}`;let userName=document.querySelector(".userName"),dateAndTime=document.querySelector(".dateAndTime");userName.innerHTML=localStorage.getItem("userNameView"),dateAndTime.innerHTML=dateNow;let tmp,users,mood="create";function openInputsAdd(){document.querySelector(".addEmployee").style.display="block",document.querySelector(".inputs").style.display="none"}users=null!=localStorage.allUsers?JSON.parse(localStorage.allUsers):[];let employeesMakeUp=[],allReserve=[];function getAllReserve(){ipcRenderer.send("get-reserve","bing"),ipcRenderer.on("get-reserve",((e,t)=>{const a=JSON.parse(t);allReserve.push(a)}))}function getReserve(){for(let e=0;e<allReserve[allReserve.length-1].length;e++)for(let t=0;t<allReserve[allReserve.length-1][e].myReserve.length;t++)numReserve.value==allReserve[allReserve.length-1][e].myReserve[t].numReserve&&(numReserve.value=allReserve[allReserve.length-1][e].myReserve[t].numReserve,dateReserve.value=allReserve[allReserve.length-1][e].myReserve[t].startReserve,nameReserve.value=allReserve[allReserve.length-1][e].myReserve[t].nameReserve)}function getPriceMakeUp(){remainMakeUp.value=priceMakeUp.value}function calcRemainMakeUp(){remainMakeUp.value=+priceMakeUp.value-+paidMakeUp.value}getAllReserve();let tmpIdDelete,tableMakeUp,createEmplMakeUp=document.querySelector(".createEmplMakeUp");function updateMakeUp(e){for(let t=0;t<employeesMakeUp[employeesMakeUp.length-1].length;t++)if(employeesMakeUp[employeesMakeUp.length-1][t]._id==e){let a=employeesMakeUp[employeesMakeUp.length-1][t].myEmployeesMakeUp;nameMakeUp.value=a.nameMakeUp,idPersonalmakeUp.value=a.idPersonalmakeUp,phoneMakeUp.value=a.phoneMakeUp,numReserve.value=a.numReserve,dateReserve.value=a.dateReserve,nameReserve.value=a.nameReserve,typeMakeUp.value=a.typeMakeUp,priceMakeUp.value=a.priceMakeUp,paidMakeUp.value=a.paidMakeUp,remainMakeUp.value=a.remainMakeUp,mood="update",nameMakeUp.focus(),scroll({top:0,behavior:"smooth"}),document.querySelector(".createEmplMakeUp").innerHTML=" تحديث البيانات",tmp=e}}function deletMakeUp(e){for(let t=0;t<users.length;t++)userName.innerHTML!=users[t].user||"it"!=users[t].job&&"مدير"!=users[t].job||(document.querySelector(".alarm").style.display="block",tmpIdDelete=e)}function checkPass(){ipcRenderer.send("delete-makeUp",tmpIdDelete),window.location.reload(),showDetailsMakeUp()}createEmplMakeUp.addEventListener("click",(e=>{let t="";""!=nameMakeUp.value&&(t={user:userName.innerHTML,date:dateNow,nameMakeUp:nameMakeUp.value,idPersonalmakeUp:idPersonalmakeUp.value,phoneMakeUp:phoneMakeUp.value,numReserve:numReserve.value,dateReserve:dateReserve.value,nameReserve:nameReserve.value,typeMakeUp:typeMakeUp.value,priceMakeUp:priceMakeUp.value,paidMakeUp:paidMakeUp.value,remainMakeUp:remainMakeUp.value},"create"==mood?(employeesMakeUp.push(t),ipcRenderer.send("myEmployeesMakeUp",t),window.location.reload()):"update"==mood&&(ipcRenderer.send("update-makeUp",{...t,tmp:tmp}),window.location.reload())),showDetailsMakeUp()}));let totalPriceMakeUp=0,totalPaidMakeUp=0,totalRemainMakeUp=0;function showDetailsMakeUp(){tableMakeUp="",ipcRenderer.send("get-makeUp","bing"),ipcRenderer.on("get-makeUp",((e,t)=>{const a=JSON.parse(t);employeesMakeUp.push(a),tableMakeUp="",a.map((e=>{totalPriceMakeUp+=+e.myEmployeesMakeUp.priceMakeUp,totalPaidMakeUp+=+e.myEmployeesMakeUp.paidMakeUp,totalRemainMakeUp+=+e.myEmployeesMakeUp.remainMakeUp,tableMakeUp+=`\n            <tr>\n                <td>${e.myEmployeesMakeUp.date}</td>\n                <td>${e.myEmployeesMakeUp.user}</td>\n                <td>${e.myEmployeesMakeUp.nameMakeUp}</td>\n                <td>${e.myEmployeesMakeUp.numReserve}</td>\n                <td>${e.myEmployeesMakeUp.dateReserve}</td>\n                <td>${e.myEmployeesMakeUp.nameReserve}</td>\n                <td>${e.myEmployeesMakeUp.typeMakeUp}</td>\n                <td>${e.myEmployeesMakeUp.priceMakeUp}</td>\n                <td>${e.myEmployeesMakeUp.paidMakeUp}</td>\n                <td class='remainMakeUp'>${e.myEmployeesMakeUp.remainMakeUp}</td>\n                <td><button onclick="printReciept1('${e._id}');">طباعة</button></td>\n                <td><button onclick="updateMakeUp('${e._id}');">تعديل</button></td>\n                <td><button onclick="deletMakeUp('${e._id}');">حذف</button></td>\n\n            </tr>\n            `})),document.querySelector(".tbodyEmployeesMakeUP1").innerHTML=tableMakeUp,tableMakeUp+=`\n        <tr>\n            <td colspan='7'>الاجمالي</td>\n            <td>${totalPriceMakeUp}</td>\n            <td>${totalPaidMakeUp}</td>\n            <td class='remainMakeUp'>${totalRemainMakeUp}</td>\n            <td colspan='3'></td>\n        </tr>\n            `,document.querySelector(".tbodyEmployeesMakeUP1").innerHTML=tableMakeUp,totalPriceMakeUp=0,totalPaidMakeUp=0,totalRemainMakeUp=0}))}function printPage(){document.querySelector(".addEmployeeMakeUp").style.display="none",document.querySelector(".searchEmployeeMakeUp").style.display="none",document.querySelector("aside").style.display="none",document.querySelector("header").style.display="none",document.querySelector(".content").style.width="100%",window.print(),window.location.reload()}showDetailsMakeUp(),document.querySelector(".viewSearchEmplMakeUp").onclick=function(){document.querySelector(".addEmployeeMakeUp").style.display="none",document.querySelector(".searchEmployeeMakeUp").style.display="block"},document.querySelector(".viewAddEmplMakeUp").onclick=function(){document.querySelector(".addEmployeeMakeUp").style.display="block",document.querySelector(".searchEmployeeMakeUp").style.display="none"};let wordSearch=document.querySelector("#wordSearch");function searchMakeName(e){document.querySelector(".tableAllEmployees1").style.display="none",document.querySelector(".tableAllEmployees2").style.display="block",tableMakeUp="";for(let t=0;t<employeesMakeUp[employeesMakeUp.length-1].length;t++)if(employeesMakeUp[employeesMakeUp.length-1][t].myEmployeesMakeUp.nameMakeUp.includes(e)){let e=employeesMakeUp[employeesMakeUp.length-1][t].myEmployeesMakeUp;totalPriceMakeUp+=+e.priceMakeUp,totalPaidMakeUp+=+e.paidMakeUp,totalRemainMakeUp+=+e.remainMakeUp,tableMakeUp+=`\n                <tr>\n                    <td>${t+1}</td>\n                    <td>${e.date}</td>\n                    <td>${e.user}</td>\n                    <td>${e.nameMakeUp}</td>\n                    <td>${e.numReserve}</td>\n                    <td>${e.dateReserve}</td>\n                    <td>${e.nameReserve}</td>\n                    <td>${e.typeMakeUp}</td>\n                    <td>${e.priceMakeUp}</td>\n                    <td>${e.paidMakeUp}</td>\n                    <td class='remainMakeUp'>${e.remainMakeUp}</td>\n                    <td><button onclick="printReciept2(${t});">طباعة</button></td>\n                    <td><button onclick="updateMakeUp(${t});">تعديل</button></td>\n                    <td><button onclick="deletMakeUp(${t});">حذف</button></td>\n                    `}tableMakeUp+=`\n        <tr>\n            <td colspan='8'>الاجمالي</td>\n            <td>${totalPriceMakeUp}</td>\n            <td>${totalPaidMakeUp}</td>\n            <td class='remainMakeUp'>${totalRemainMakeUp}</td>\n            <td colspan='3'></td>\n        </tr>\n        `,document.querySelector(".tbodyEmployeesMakeUP2").innerHTML=tableMakeUp,totalPriceMakeUp=0,totalPaidMakeUp=0,totalRemainMakeUp=0}function printReciept1(e){for(let t=0;t<employeesMakeUp[employeesMakeUp.length-1].length;t++)if(employeesMakeUp[employeesMakeUp.length-1][t]._id==e){let e=employeesMakeUp[employeesMakeUp.length-1][t].myEmployeesMakeUp;document.querySelector(".content").style.display="none",document.querySelector("header").style.display="none",document.querySelector("aside").style.display="none",document.querySelector(".receipt").style.display="block",document.querySelectorAll(".receiptMakeUpName")[0].innerHTML=e.nameMakeUp,document.querySelectorAll(".receiptMakeUpName")[1].innerHTML=e.nameMakeUp,document.querySelectorAll(".receiptUserName")[0].innerHTML=e.user,document.querySelectorAll(".receiptUserName")[1].innerHTML=e.user,document.querySelectorAll(".receiptDateReserve")[0].innerHTML=e.dateReserve,document.querySelectorAll(".receiptDateReserve")[1].innerHTML=e.dateReserve,document.querySelectorAll(".receiptNumReserve")[0].innerHTML=e.numReserve,document.querySelectorAll(".receiptNumReserve")[1].innerHTML=e.numReserve,document.querySelectorAll(".receiptNamePers")[0].innerHTML=e.nameReserve,document.querySelectorAll(".receiptNamePers")[1].innerHTML=e.nameReserve,document.querySelectorAll(".receiptItems")[0].innerHTML=e.typeMakeUp,document.querySelectorAll(".receiptItems")[1].innerHTML=e.typeMakeUp,document.querySelectorAll(".receiptPriceItems")[0].innerHTML=e.priceMakeUp,document.querySelectorAll(".receiptPriceItems")[1].innerHTML=e.priceMakeUp,document.querySelectorAll(".receiptPaid")[0].innerHTML=+e.paidMakeUp,document.querySelectorAll(".receiptPaid")[1].innerHTML=+e.paidMakeUp,document.querySelectorAll(".receiptRemain")[0].innerHTML=e.remainMakeUp,document.querySelectorAll(".receiptRemain")[1].innerHTML=e.remainMakeUp,document.querySelectorAll(".receiptDateNow")[0].innerHTML=e.date,document.querySelectorAll(".receiptDateNow")[1].innerHTML=e.date,document.querySelectorAll(".receiptRecieve")[0].innerHTML=e.user,document.querySelectorAll(".receiptRecieve")[1].innerHTML=e.user,window.print(),window.location.reload()}}function printReciept2(e){let t=employeesMakeUp[employeesMakeUp.length-1][e].myEmployeesMakeUp;document.querySelector(".content").style.display="none",document.querySelector("header").style.display="none",document.querySelector("aside").style.display="none",document.querySelector(".receipt").style.display="block",document.querySelectorAll(".receiptMakeUpName")[0].innerHTML=t.nameMakeUp,document.querySelectorAll(".receiptMakeUpName")[1].innerHTML=t.nameMakeUp,document.querySelectorAll(".receiptUserName")[0].innerHTML=t.user,document.querySelectorAll(".receiptUserName")[1].innerHTML=t.user,document.querySelectorAll(".receiptDateReserve")[0].innerHTML=t.dateReserve,document.querySelectorAll(".receiptDateReserve")[1].innerHTML=t.dateReserve,document.querySelectorAll(".receiptNumReserve")[0].innerHTML=t.numReserve,document.querySelectorAll(".receiptNumReserve")[1].innerHTML=t.numReserve,document.querySelectorAll(".receiptNamePers")[0].innerHTML=t.nameReserve,document.querySelectorAll(".receiptNamePers")[1].innerHTML=t.nameReserve,document.querySelectorAll(".receiptItems")[0].innerHTML=t.typeMakeUp,document.querySelectorAll(".receiptItems")[1].innerHTML=t.typeMakeUp,document.querySelectorAll(".receiptPriceItems")[0].innerHTML=t.priceMakeUp,document.querySelectorAll(".receiptPriceItems")[1].innerHTML=t.priceMakeUp,document.querySelectorAll(".receiptPaid")[0].innerHTML=+t.paidMakeUp,document.querySelectorAll(".receiptPaid")[1].innerHTML=+t.paidMakeUp,document.querySelectorAll(".receiptRemain")[0].innerHTML=t.remainMakeUp,document.querySelectorAll(".receiptRemain")[1].innerHTML=t.remainMakeUp,document.querySelectorAll(".receiptDateNow")[0].innerHTML=t.date,document.querySelectorAll(".receiptDateNow")[1].innerHTML=t.date,document.querySelectorAll(".receiptRecieve")[0].innerHTML=t.user,document.querySelectorAll(".receiptRecieve")[1].innerHTML=t.user,window.print(),window.location.reload()}function exitePass(){window.location.reload()}function refresh(){window.location.reload()}document.querySelector(".receipt").onclick=function(){document.querySelector(".receipt").style.display="none",document.querySelector(".content").style.display="block",document.querySelector("header").style.display="flex",document.querySelector("aside").style.display="block"};