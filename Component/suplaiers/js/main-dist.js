const{ipcRenderer:ipcRenderer}=require("electron");let dateNow,date=new Date;dateNow=date.getMonth()+1<10&&date.getDate()<10?`${date.getFullYear()}-0${date.getMonth()+1}-0${date.getDate()}`:date.getMonth()+1<10&&date.getDate()>10?`${date.getFullYear()}-0${date.getMonth()+1}-${date.getDate()}`:date.getMonth()+1>10&&date.getDate()<10?`${date.getFullYear()}-${date.getMonth()+1}-0${date.getDate()}`:`${date.getFullYear()}-${date.getMonth()+1}-${date.getDate()}`;let userName=document.querySelector(".userName"),dateAndTime=document.querySelector(".dateAndTime");userName.innerHTML=localStorage.getItem("userNameView"),dateAndTime.innerHTML=dateNow;let tmp,users,mood="create";function openInputsAdd(){document.querySelector(".addEmployee").style.display="block",document.querySelector(".inputs").style.display="none"}users=null!=localStorage.allUsers?JSON.parse(localStorage.allUsers):[],document.querySelector(".receipt").onclick=function(){document.querySelector(".receipt").style.display="none",document.querySelector(".content").style.display="block",document.querySelector("header").style.display="flex",document.querySelector("aside").style.display="block"};let tmpSuppliers,nameSuppliers=document.querySelector("#nameSuppliers"),idPersonalSuppliers=document.querySelector("#idPersonalSuppliers"),phoneSuppliers=document.querySelector("#phoneSuppliers"),typeItems=document.querySelector("#typeItems"),numItems=document.querySelector("#numItems"),priceItems=document.querySelector("#priceItems"),Totalprice=document.querySelector("#Totalprice"),paidSuppliers=document.querySelector("#paidSuppliers"),remainSuppliers=document.querySelector("#remainSuppliers"),moodSuppliers="create",suppliers=[];function getTotalSupp(){Totalprice.value=+numItems.value*+priceItems.value}function getPriceSuppliers(){remainSuppliers.value=Totalprice.value}function calcRemainSuppliers(){remainSuppliers.value=+Totalprice.value-+paidSuppliers.value}let tmpIdDelete,tableSuppliers,createSuppliers=document.querySelector(".createSuppliers");function updateSuppliers(e){for(let t=0;t<suppliers[suppliers.length-1].length;t++)if(suppliers[suppliers.length-1][t]._id==e){let p=suppliers[suppliers.length-1][t].mySuppliers;nameSuppliers.value=p.nameSuppliers,idPersonalSuppliers.value=p.idPersonalSuppliers,phoneSuppliers.value=p.phoneSuppliers,typeItems.value=p.typeItems,Totalprice.value=p.Totalprice,paidSuppliers.value=p.paidSuppliers,remainSuppliers.value=p.remainSuppliers,mood="update",nameSuppliers.focus(),scroll({top:0,behavior:"smooth"}),document.querySelector(".createSuppliers").innerHTML="تحديث البيانات",tmp=e}}function deletSuppliers(e){for(let t=0;t<users.length;t++)userName.innerHTML!=users[t].user||"it"!=users[t].job&&"مدير"!=users[t].job||(document.querySelector(".alarm").style.display="block",tmpIdDelete=e)}function checkPass(){ipcRenderer.send("delete-suppliers",tmpIdDelete),window.location.reload(),showDetailsSuppliers()}function exitePass(){window.location.reload()}createSuppliers.addEventListener("click",(e=>{let t="";""!=nameSuppliers.value&&(t={user:userName.innerHTML,date:dateNow,nameSuppliers:nameSuppliers.value,idPersonalSuppliers:idPersonalSuppliers.value,phoneSuppliers:phoneSuppliers.value,typeItems:typeItems.value,Totalprice:Totalprice.value,paidSuppliers:paidSuppliers.value,remainSuppliers:remainSuppliers.value},"create"==mood?(ipcRenderer.send("mySuppliers",t),window.location.reload()):"update"==mood&&(ipcRenderer.send("update-suppliers",{...t,tmp:tmp}),window.location.reload())),showDetailsSuppliers()}));let totalPriceSuppliers=0,totalPaidSuppliers=0,totalRemainSuppliers=0;function showDetailsSuppliers(){tableSuppliers="",ipcRenderer.send("get-suppliers","bing"),ipcRenderer.on("get-suppliers",((e,t)=>{const p=JSON.parse(t);suppliers.push(p),tableSuppliers="",p.map((e=>{totalPriceSuppliers+=+e.mySuppliers.Totalprice,totalPaidSuppliers+=+e.mySuppliers.paidSuppliers,totalRemainSuppliers+=+e.mySuppliers.remainSuppliers,tableSuppliers+=`\n            <tr>\n                <td>${e.mySuppliers.date}</td>\n                <td>${e.mySuppliers.user}</td>\n                <td>${e.mySuppliers.nameSuppliers}</td>\n                <td>${e.mySuppliers.typeItems}</td>\n                <td>${e.mySuppliers.Totalprice}</td>\n                <td>${e.mySuppliers.paidSuppliers}</td>\n                <td>${e.mySuppliers.remainSuppliers}</td>\n                <td><button onclick="updateSuppliers('${e._id}');">تعديل</button></td>\n                <td><button onclick="deletSuppliers('${e._id}');">حذف</button></td>\n\n            </tr>\n            `})),tableSuppliers+=`\n            <tr>\n                <td colspan='4'>الاجمالي</td>\n                <td>${totalPriceSuppliers}</td>\n                <td>${totalPaidSuppliers}</td>\n                <td class='remainMakeUp'>${totalRemainSuppliers}</td>\n                <td colspan='3'></td>\n            </tr>\n                `,document.querySelector(".tbodySuppliers").innerHTML=tableSuppliers,totalPriceSuppliers=0,totalPaidSuppliers=0,totalRemainSuppliers=0}))}function colorRemainSuppliers(){let e=document.querySelectorAll(".remainSuppliers");for(let t=0;t<e.length;t++)e[t].innerHTML<0?e[t].style.color="red":e[t].innerHTML>0&&(e[t].style.color="green")}function printPage(){document.querySelector(".addSuppliers").style.display="none",document.querySelector(".searchSuppliers").style.display="none",document.querySelector("aside").style.display="none",document.querySelector("header").style.display="none",document.querySelector(".content").style.width="100%",window.print(),window.location.reload()}showDetailsSuppliers(),colorRemainSuppliers(),document.querySelector(".viewSearchSuppliers").onclick=function(){document.querySelector(".addSuppliers").style.display="none",document.querySelector(".searchSuppliers").style.display="block"},document.querySelector(".viewAddSuppliers").onclick=function(){document.querySelector(".addSuppliers").style.display="block",document.querySelector(".searchSuppliers").style.display="none"};let wordSearchSuppliers=document.querySelector("#wordSearchSuppliers");function searchSuppliers(e){tableSuppliers="";for(let t=0;t<suppliers[suppliers.length-1].length;t++)(e.includes(suppliers[suppliers.length-1][t].mySuppliers.nameSuppliers)||e.includes(suppliers[suppliers.length-1][t].mySuppliers.date))&&(totalPriceSuppliers+=+suppliers[suppliers.length-1][t].mySuppliers.Totalprice,totalPaidSuppliers+=+suppliers[suppliers.length-1][t].mySuppliers.paidSuppliers,totalRemainSuppliers+=+suppliers[suppliers.length-1][t].mySuppliers.remainSuppliers,tableSuppliers+=`\n            <tr>\n                <td>${suppliers[suppliers.length-1][t].mySuppliers.date}</td>\n                <td>${suppliers[suppliers.length-1][t].mySuppliers.user}</td>\n                <td>${suppliers[suppliers.length-1][t].mySuppliers.nameSuppliers}</td>\n                <td>${suppliers[suppliers.length-1][t].mySuppliers.typeItems}</td>\n                <td>${suppliers[suppliers.length-1][t].mySuppliers.Totalprice}</td>\n                <td>${suppliers[suppliers.length-1][t].mySuppliers.paidSuppliers}</td>\n                <td>${suppliers[suppliers.length-1][t].mySuppliers.remainSuppliers}</td>\n                <td><button onclick="printReciept(${t});">طباعة</button></td>\n                <td><button onclick="updateSuppliers(${t});">تعديل</button></td>\n                <td><button onclick="deletSuppliers(${t});">حذف</button></td>\n\n            </tr>\n            `);tableSuppliers+=`\n        <tr>\n            <td colspan='4'>الاجمالي</td>\n            <td>${totalPriceSuppliers}</td>\n            <td>${totalPaidSuppliers}</td>\n            <td class='remainMakeUp'>${totalRemainSuppliers}</td>\n            <td colspan='3'></td>\n        </tr>\n            `,document.querySelector(".tbodySuppliers").innerHTML=tableSuppliers,totalPriceSuppliers=0,totalPaidSuppliers=0,totalRemainSuppliers=0}function refresh(){window.location.reload()}