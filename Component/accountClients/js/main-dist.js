const{ipcRenderer:ipcRenderer}=require("electron");let tmpEmpl,dateNow,monthNow,addSalary=document.querySelector("#createSalary"),datePayroll=document.querySelector("#datePayroll"),paidPay=document.querySelector("#salaryPay"),inputSalary=document.querySelector("#inputSalary"),nameEmployee=document.querySelector("#name"),idPersonal=document.querySelector("#idPersonal"),phone=document.querySelector("#phone"),job=document.querySelector("#job"),salary=document.querySelector("#salary"),date=new Date,numReserve=document.querySelector("#numReserve"),dateReserve=document.querySelector("#dateReserve"),nameReserve=document.querySelector("#nameReserve");dateNow=date.getMonth()+1<10&&date.getDate()<10?`${date.getFullYear()}-0${date.getMonth()+1}-0${date.getDate()}`:date.getMonth()+1<10&&date.getDate()>10?`${date.getFullYear()}-0${date.getMonth()+1}-${date.getDate()}`:date.getMonth()+1>10&&date.getDate()<10?`${date.getFullYear()}-${date.getMonth()+1}-0${date.getDate()}`:`${date.getFullYear()}-${date.getMonth()+1}-${date.getDate()}`,monthNow=date.getMonth()+1<10?`${date.getFullYear()}-0${date.getMonth()+1}`:`${date.getFullYear()}-${date.getMonth()+1}`,datePayroll.value=monthNow;let userName=document.querySelector(".userName"),dateAndTime=document.querySelector(".dateAndTime");userName.innerHTML=localStorage.getItem("userNameView"),dateAndTime.innerHTML=dateNow;let tmp,users,mood="create";function openInputsAdd(){document.querySelector(".inputsEmployees").style.display="block",document.querySelector(".inputsSalary").style.display="none"}users=null!=localStorage.allUsers?JSON.parse(localStorage.allUsers):[];let optionItems,tmpIdDelete1,allSalary=[],selectEmployeeName=document.querySelector("#selectEmployeeName");function addEmployee(){if(""!=(nameEmployee.value&&idPersonal.value&&job.value&&salary.value)){let e={user:userName.innerHTML,date:dateNow,name:nameEmployee.value,idPersonal:idPersonal.value,phone:phone.value,job:job.value,salary:salary.value};"create"==mood?(ipcRenderer.send("myEmployees",e),window.location.reload()):(ipcRenderer.send("update-employees",{...e,tmpEmpl:tmpEmpl}),mood="create",window.location.reload())}showEmployees()}function updateEmployee(e){for(let l=0;l<users.length;l++)if(userName.innerHTML==users[l].user&&("it"==users[l].job||"مدير"==users[l].job)){document.querySelector(".addEmployee").style.display="block",document.querySelector(".inputs").style.display="none",tmpEmpl=e;for(let l=0;l<allEmployees[allEmployees.length-1].length;l++){if(allEmployees[allEmployees.length-1][l]._id===e){let e=allEmployees[allEmployees.length-1][l].myEmployees;nameEmployee.value=e.name,idPersonal.value=e.idPersonal,phone.value=e.phone,job.value=e.job,salary.value=e.salary}nameEmployee.focus(),scroll({top:0,behavior:"smooth"}),mood="update",document.querySelector(".createEmpl").innerHTML="تحديث بيانات"}}}function deleteEmployee(e){for(let l=0;l<users.length;l++)userName.innerHTML!=users[l].user||"it"!=users[l].job&&"مدير"!=users[l].job||(document.querySelector(".alarm1").style.display="block",tmpIdDelete1=e)}function checkPass1(){ipcRenderer.send("delete-employees",id),window.location.reload(),showEmployees()}let allEmployees=[];function showEmployees(){let e="";ipcRenderer.send("get-employees","bing"),ipcRenderer.on("get-employees",((l,a)=>{const t=JSON.parse(a);allEmployees.push(t),e="",optionItems="",t.map((l=>{e+=`\n            <tr>\n                <td>${l.myEmployees.date}</td>\n                <td>${l.myEmployees.name}</td>\n                <td>${l.myEmployees.salary}</td>\n                <td><button onclick="updateEmployee('${l._id}');">تعديل</button></td>\n                <td><button onclick="deleteEmployee('${l._id}');">حذف</button></td>\n\n            </tr>\n            `,optionItems+=`\n        <option>${l.myEmployees.name}</option>\n        `,selectEmployeeName.innerHTML=optionItems,selectEmployeeName.value=optionItems})),document.querySelector(".tbodyEmployees").innerHTML=e}))}function selectEmpl(){for(let e=0;e<allEmployees[allEmployees.length-1].length;e++)selectEmployeeName.value==allEmployees[allEmployees.length-1][e].myEmployees.name&&(inputSalary.value=allEmployees[allEmployees.length-1][e].myEmployees.salary)}showEmployees();let resultTotalPaid=0;addSalary.onclick=function(){let e="";""!==(selectEmployeeName.value&&paidPay.value)&&(e={user:userName.innerHTML,date:dateNow,name:selectEmployeeName.value,month:datePayroll.value,salary:inputSalary.value,paidPay:paidPay.value},"create"===mood?(ipcRenderer.send("mySalary",e),window.location.reload()):"update"==mood&&(ipcRenderer.send("update-salary",{...e,tmp:tmp}),window.location.reload())),showAllSalary()};let tmpIdDelete2,tableSalary="",resultSalary=0;function showAllSalary(){ipcRenderer.send("get-salary","bing"),ipcRenderer.on("get-salary",((e,l)=>{const a=JSON.parse(l);allSalary.push(a),tableSalary="",resultSalary=0,a.map((e=>{e.mySalary.month==monthNow&&(resultSalary+=+e.mySalary.paidPay,tableSalary+=`\n                <tr>\n                    <td>${e.mySalary.date}</td>\n                    <td>${e.mySalary.name}</td>\n                    <td>${e.mySalary.salary}</td>\n                    <td>${e.mySalary.month}</td>\n                    <td>${e.mySalary.paidPay}</td>\n                    <td><button onclick="updateSalary('${e._id}');">تعديل</button></td>\n                    <td><button onclick="deleteSalary('${e._id}');">حذف</button></td>\n                </tr>\n                \n                `)})),document.querySelector(".tbodySalarys1").innerHTML=tableSalary,tableSalary="",resultSalary=0}))}function updateSalary(e){for(let l=0;l<users.length;l++)if(userName.innerHTML==users[l].user&&("it"==users[l].job||"مدير"==users[l].job))for(let l=0;l<allSalary[allSalary.length-1].length;l++)if(allSalary[allSalary.length-1][l]._id==e){let a=allSalary[allSalary.length-1][l].mySalary;selectEmployeeName.value=a.name,inputSalary.value=a.salary,datePayroll.value=a.month,paidPay.value=a.paidPay,paidPay.focus(),scroll({top:0,behavior:"smooth"}),mood="update",tmp=e,document.querySelector("#createSalary").innerHTML="تحديث البيانات"}}function deleteSalary(e){for(let l=0;l<users.length;l++)userName.innerHTML!=users[l].user||"it"!=users[l].job&&"مدير"!=users[l].job||(document.querySelector(".alarm2").style.display="block",tmpIdDelete2=e)}function checkPass2(){ipcRenderer.send("delete-salary",tmpIdDelete2),window.location.reload(),showAllSalary()}function searchSalary(){tableSalary="",resultSalary=0,document.querySelector(".tableSearch").style.display="block",document.querySelector(".tableSalary").style.display="none";for(let e=0;e<allSalary[allSalary.length-1].length;e++){let l=allSalary[allSalary.length-1][e].mySalary;selectEmployeeName.value==l.name&&datePayroll.value==l.month&&(resultSalary+=+l.paidPay,tableSalary+=`\n                <tr>\n                    <td>${l.date}</td>\n                    <td>${l.name}</td>\n                    <td>${l.salary}</td>\n                    <td>${l.month}</td>\n                    <td>${l.paidPay}</td>\n                    <td>${+l.salary-resultSalary}</td>\n                </tr>\n                \n                `)}document.querySelector(".tbodySalarys2").innerHTML=tableSalary,tableSalary="",resultSalary=0}function returnpageEmployees(){document.querySelector(".tableDetailsEmployee").style.display="none",document.querySelector(".tableAllEmployees").style.display="block"}function printThisPage(){document.querySelector("header").style.display="none",document.querySelector("aside").style.display="none",document.querySelector(".content").style.width="100%",document.querySelector("#addSalary").style.display="none",window.print(),window.location.reload()}function exiteTable(){document.querySelector(".tablePrint").style.display="none",document.querySelector(".app").style.display="block"}function getReserve(){for(let e=0;e<reserve.length;e++)numReserve.value==reserve[e].numReserve&&(numReserve.value=reserve[e].numReserve,dateReserve.value=reserve[e].startReserve,nameReserve.value=reserve[e].nameReserve)}function refresh(){window.location.reload()}function exitePass(){window.location.reload()}showAllSalary();