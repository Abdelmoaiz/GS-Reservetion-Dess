function refreshAuto(){window.location.reload()}const{ipcRenderer:ipcRenderer}=require("electron"),{stat:stat}=require("original-fs");let users,create=document.querySelector("#create"),barcode=document.querySelector("#barcode"),title=document.querySelector("#title"),color=document.querySelector("#color"),priceNight=document.querySelector("#priceNight"),itemsState=document.querySelector("#itemsState"),date=new Date,userName=document.querySelector(".userName"),dateAndTime=document.querySelector(".dateAndTime");userName.innerHTML=localStorage.getItem("userNameView"),date.getMonth()+1<10&&date.getDate()<10?dateAndTime.innerHTML=`${date.getFullYear()}-0${date.getMonth()+1}-0${date.getDate()}`:date.getMonth()+1<10&&date.getDate()>=10?dateAndTime.innerHTML=`${date.getFullYear()}-0${date.getMonth()+1}-${date.getDate()}`:date.getMonth()+1>=10&&date.getDate()<10?dateAndTime.innerHTML=`${date.getFullYear()}-${date.getMonth()+1}-0${date.getDate()}`:dateAndTime.innerHTML=`${date.getFullYear()}-${date.getMonth()+1}-${date.getDate()}`,users=null!=localStorage.allUsers?JSON.parse(localStorage.allUsers):[];let tmp,mood="create";function addItems(){document.querySelector(".inputs").style.display="block"}function exitInput(){document.querySelector(".inputs").style.display="none"}let items,Upload=document.querySelector("#upload"),img=document.querySelector("#img");function checkBarcode(){for(let e=0;e<mydataPro[mydataPro.length-1].length;e++){mydataPro[mydataPro.length-1][e].item;barcode.value.includes(mydataPro[mydataPro.length-1][e].myItems.barcode)&&(barcode.value="")}}Upload.onchange=function(){let e=new FileReader;e.readAsDataURL(Upload.files[0]),e.onload=function(){img.setAttribute("src",e.result)}},items=null!=localStorage.myItems?JSON.parse(localStorage.myItems):[],create.addEventListener("click",(e=>{if(""!=(barcode.value&&title.value&&color.value)){let e={barcode:barcode.value,title:title.value,color:color.value,priceNight:+priceNight.value,state:itemsState.value,img:img.src};"create"===mood?(items.push(e),ipcRenderer.send("myItems",e),localStorage.setItem("myItems",JSON.stringify(items))):"update"===mood&&(create.innerHTML=" اضافة الصنف",ipcRenderer.send("update-items",{...e,tmp:tmp}))}showItems()}));let tmpIdDelete,mydataPro=[];function showItems(){let e="";ipcRenderer.send("get-Data","bing"),ipcRenderer.on("get-Data",((t,o)=>{const a=JSON.parse(o);mydataPro.push(a),e="",a.map((t=>{e+=`\n                    <tr>\n                        <td>${t.myItems.barcode}</td>\n                        <td>${t.myItems.title}</td>\n                        <td>${t.myItems.color}</td>\n                        <td>${t.myItems.priceNight}</td>\n                        <td>${t.myItems.state}</td>\n                        <td><img class='imgItems' onclick="viewImg('${t._id}');" src="" /></td>\n                        <td><button onclick="updateData('${t._id}');">تعديل</button></td>\n                        <td><button onclick="deleteData('${t._id}');">حذف</button></td>\n                    </tr>\n                        \n                `})),document.querySelector(".tbodyItems").innerHTML=e}))}function viewImg(e){console.log(e),document.querySelector(".View").style.display="block"}function hideImg(){document.querySelector(".View").style.display="none"}function updateData(e){document.querySelector(".inputs").style.display="block",tmp=e;for(let t=0;t<mydataPro[mydataPro.length-1].length;t++)if(mydataPro[mydataPro.length-1][t]._id===e){let e=mydataPro[mydataPro.length-1][t];barcode.value=e.myItems.barcode,title.value=e.myItems.title,color.value=e.myItems.color,priceNight.value=e.myItems.priceNight,itemsState.value=e.myItems.state}title.focus(),scroll({top:0,behavior:"smooth"}),create.innerHTML="تحديث",mood="update"}function deleteData(e){for(let t=0;t<users.length;t++)userName.innerHTML!=users[t].user||"it"!=users[t].job&&"مدير"!=users[t].job||(document.querySelector(".alarm").style.display="block",tmpIdDelete=e)}function checkPass(){ipcRenderer.send("delete-items",tmpIdDelete),window.location.reload(),showItems()}showItems();let searchBarcode=document.querySelector("#searchBarcode"),searchMood="barcode",btnSearch=document.querySelector("#btnSearch"),stateSearch=document.querySelector("#stateSearch"),nameSearch=document.querySelector("#nameSearch");function search(e){let t="";for(let o=0;o<items.length;o++)items[o].barcode.includes(e.toLowerCase())?t+=`\n                    <tr>\n                    <td>${o+1}</td>\n                    <td><mark>${items[o].barcode}</mark></td>\n                    <td>${items[o].title}</td>\n                    <td>${items[o].color}</td>\n                    <td>${items[o].priceNight}</td>\n                    <td>${items[o].state}</td>\n                    <td onclick="viewImg(${o});"><img src="${items[o].img}" /></td>\n                    <td><button onclick="updateData(${o});">تعديل</button></td>\n                    <td><button onclick="deleteData(${o});">حذف</button></td>\n                        \n                    </tr>\n                `:items[o].title.includes(e.toLowerCase())?t+=`\n                        <tr>\n                        <td>${o+1}</td>\n                        <td>${items[o].barcode}</td>\n                        <td><mark>${items[o].title}</mark></td>\n                        <td>${items[o].color}</td>\n                        <td>${items[o].priceNight}</td>\n                        <td>${items[o].state}</td>\n                        <td onclick="viewImg(${o});"><img src="${items[o].img}" /></td>\n                        <td><button onclick="updateData(${o});">تعديل</button></td>\n                        <td><button onclick="deleteData(${o});">حذف</button></td>\n                            \n                        </tr>\n                    `:items[o].color.includes(e.toLowerCase())&&(t+=`\n                        <tr>\n                        <td>${o+1}</td>\n                        <td>${items[o].barcode}</td>\n                        <td>${items[o].title}</td>\n                        <td><mark>${items[o].color}</mark></td>\n                        <td>${items[o].priceNight}</td>\n                        <td>${items[o].state}</td>\n                        <td onclick="viewImg(${o});"><img src="${items[o].img}" /></td>\n                        <td><button onclick="updateData(${o});">تعديل</button></td>\n                        <td><button onclick="deleteData(${o});">حذف</button></td>\n                            \n                        </tr>\n                    `);document.querySelector(".tbodyItems").innerHTML=t}function exitePass(e){window.location.reload()}